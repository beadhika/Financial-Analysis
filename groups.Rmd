---
title: "Groups"
author: "Benjan"
date: "7/8/2022"
output: pdf_document
---

# A. Introduction 

## 1. Abstract
The goal of this project is to provide an individual investor a platform to organize and implement their ideas of the market. This project is in no way fully objective nor a concrete roadmap for investing. 

## 2. Procedure 
- Make an Excel sheet to create a table to record information of each stock that you want to analyze. 

- Find a website for records of financial statements: Balance sheet, Income Statement, Cash Flow Statement and other statistical ratios. 

- Analyze the financial statements and ascertain values to each stocks in the Excel sheet. 

- Use R to filter the stocks.

## 3. Explanation of the table

### a. Section 1
This section consists of the attributes or columns which can take only three values: -1, 0, and 1. Intuitively, -1 means bad, 1 means good and 0 means neutral or indecisive. 
The reason for taking this approach is for simplicity in analysis. To better understand the reasoning,let us look at the asset attribute only. Lets suppose the asset column records the exact amount of asset of a company and say, for a company this value is 1 billion. All we can infer from this is that this is a fairly big company. But, we cannot invest on a company because it is big. What we would like to see in a company we want to invest is that it's asset is growing. So, we want look at the record of a few years and if we want to record the exact values of asset of each year, the single attribute asset will have multiple attribute within itself. This will make our table three dimensional and difficult to analyse. Again, as the purpose of this project is not to make accurate predictions but to help individual investors organize and implement their knowledge, we take a subjective approach: to look at the asset of multiple years of a company and give a value accordingly. Additionaly, the latest year data is given maximum weight. 

Lets read the Excel sheet I created and have a look at it.  
```{r}
library(readxl)
library(tidyverse)
financial <- read_excel("July 3.2022.xlsx")
head(financial)


```

The attributes and their brief introduction are: 
Assets - property or resources of a company

_Dividends_ - timely payout by a company to its shareholders as a celebration of its profits. No dividends get -1, minimal get 0 and healthy or growing dividends get 1. 

_Equity_ - net money of the shareholders. 

_Total Revenue_ - amount generated by selling of goods or services.

_Net Income_ - net amount generated after deducting the expenses from revenue. 

_CFO_ - cash generated from operations.

_Net cash flow_ - net cash generated , this includes cash from operations, financing or loans and investments.

_Quick Ratio_ - ratio of cash to current liabilities. Current liabilities are amount that needs to be paid by the company in the near-term future. 

_Debt/Equity_ - ratio of debt to equity. 

### b. Section 2 

_SUM_ - It is the sum of all scores of measures in section 1. It concludes if the company is good or bad, fundamentaly.The highest is 9 and it means the company excels in part of its financial measures.

_Other Informations_  - Any critical information associated with the company that can essential in making investing decisions. 

_PE_ - ratio of share price to earnings. A popular measure of if the company is fairly valued or not. 

_Area_ - the field of operation the company is associated to. For instance, Ford's Area is "Auto". 

_PB_ - ratio of share price to its book value. Book value is the equity divided by number of shareholders. Again, a popular measure of if the company is fairly valued.

_Value_ - I had two metrics for measuring the value of a company: PE and PB. I wanted to use both to see if a company is valued fairly compared to its competitors. I used a formula $\frac{144}{PE * PB^2}$. This is something I came up for personal use after trial and error. The logic behind this formula is to encompass both PE and PB in one formula. The PB values are generally smaller, so without the square , they did not have equal weight as the PE values and thus, I decided to use the squared PB values. I wanted the measure of 1 to be assigned to a fairly valued company (not overvalued neither undervalued). For this, I looked for the average historic value of PE for US markets as measured by SPY and it was approximately 16. I found that PB value of 3 is fair and thus, I used the number 144 to get 1 in the equation when we multiply 16 and square of 3. 

# B. Using R to filter

## 1. Overall Approach

### Entity selection

First of all, we want to remove company that are doing bad in their operations. We will also want to remove companies that have a weak foundation, that is who might not have enough cash to pay their near term liabilities. As there are chances of recession, this is critical as we only want companies that can come out of this situation. 


```{r}
fin <- arrange(financial,desc(Value))
subset <- fin %>%
    filter(fin["Net Income"]>=0,fin["Net Cash Flow"]>=0,
               fin["Quick Ratio(CA/CL)"]>=0,!is.na(Value))

```

### Comparison 

Now, as we have removed companies that satisy certain attributes, we do not need to view these attributes in our table. So, we will only select the other necessary columns. 
```{r}
sub1 <- select(subset,Stocks,Value,SUM,Area)
head(sub1)
```

Here, we will arrange the cleaned dataframe in order of their descending values and select stocks by looking at their "SUM" and "Value". 
Similarly, we will group these by Area as we want to diversify our selection. 

```{r}
sub2 <- group_by(sub1,Area)
group_split(sub2)
group_keys(sub2)
```

### Candidates 
Looking at the grouped_table, we have the following candidates: F, TCEHY, BABA, AMD, TSM, C, COIN, MRNA, PFE, SHEL, ET, META, GOOGL, ZIM. 

We'll look at the 'Other Informations' column. 

```{r}
final <- fin %>%
    filter(Stocks %in% c("F","TCEHY","BABA","AMD","TSM","C","COIN","MRNA","PFE","SHEL","ET","META","GOOGL","ZIM")) %>%
    select(Stocks, `Other Informations`)
final

```

We can select stocks to buy from the refined list after considering the details given in the 'Other Informations' column. 

## 2.Value Approach
While refining the data, we selected the stocks with good overall financials. We could have dropped stocks which were undervalued but had bad financial situation in one attribute. So, here we will filter and look at those stocks that might have great value. 

```{r}
sub3 <- fin %>%
    filter(Value >= 5) %>%
    select(Stocks,Value,SUM,PB,Area)
```
Let's only filter the stocks that were not in the final refined data of first part. 
```{r}
sub4 <- filter(sub3,!(Stocks %in% final$Stocks))
sub4
```

## 3. Utility approach

```{r}
sub5 <- fin %>%
    filter(SUM >= 7) %>%
    select(Stocks,Value,SUM,PB,Area)
```

```{r}
sub6 <- filter (sub5,!(Stocks %in% final$Stocks | Stocks %in% sub4$Stocks))

sub6
```

## 4. Elimination
```{r}
sub7 <- fin %>%
    filter(is.na(PB) | Value <= 1/10 | PB >=10)
sub7[,c("Stocks","Value","SUM","PB")]
```

